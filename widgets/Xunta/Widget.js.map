{"version":3,"sources":["../../../widgets/Xunta/Widget.js"],"names":["define","declare","BaseWidget","Query","QueryTask","lang","SpatialReference","Graphic","SimpleFillSymbol","baseClass","cargaConcellos","codigoProvincia","selectProvincias","value","selectConcellos","innerHTML","queryTask","config","concellosService","query","returnGeometry","outFields","orderByFields","where","execute","hitch","results","opt","document","createElement","text","add","i","features","length","attributes","CODCONC","CONCELLO","cargaParroquias","codigoParroquia","selectParroquias","parroquiasService","CODPARRO","PARROQUIA","zoomConcello","codigoConcello","outSpatialReference","console","log","geom","geometry","map","graphics","clear","setExtent","getExtent","zoomParroquia"],"mappings":"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","file":"Widget.js","sourcesContent":["define(['dojo/_base/declare', 'jimu/BaseWidget', \"esri/tasks/query\", \"esri/tasks/QueryTask\", \"dojo/_base/lang\", \"esri/SpatialReference\", \"esri/graphic\", \"esri/symbols/SimpleFillSymbol\"],\r\nfunction(declare, BaseWidget, Query, QueryTask, lang, SpatialReference, Graphic, SimpleFillSymbol) {\r\n\r\n  return declare([BaseWidget], {\r\n\r\n    baseClass: 'xunta',\r\n    \r\n    cargaConcellos() {\r\n      let codigoProvincia = this.selectProvincias.value;\r\n      if (codigoProvincia === -1) return;\r\n\r\n      this.selectConcellos.innerHTML = '';\r\n\r\n      const queryTask = new QueryTask(this.config.concellosService);\r\n\r\n      const query = new Query();\r\n      query.returnGeometry = false;\r\n      query.outFields = [\"CODCONC\", \"CONCELLO\"];\r\n      query.orderByFields = [\"CONCELLO\"];\r\n      query.where = \"CODPROV = \" + codigoProvincia;\r\n\r\n      queryTask.execute(query, lang.hitch(this, function(results) {\r\n        let opt = document.createElement('option');\r\n        opt.value = -1;\r\n        opt.text = \"Seleccione concello\";\r\n        this.selectConcellos.add(opt);\r\n        for (let i = 0; i < results.features.length; i++) {\r\n          opt = document.createElement('option');\r\n          opt.value = results.features[i].attributes.CODCONC;\r\n          opt.text = results.features[i].attributes.CONCELLO;\r\n          this.selectConcellos.add(opt);\r\n        }\r\n      }));\r\n    },\r\n\r\n    cargaParroquias() {\r\n      let codigoParroquia = this.selectConcellos.value;\r\n      if (codigoParroquia === -1) return;\r\n      this.selectParroquias.innerHTML = '';\r\n\r\n      const queryTask = new QueryTask(this.config.parroquiasService);\r\n      const query = new Query();\r\n      query.returnGeometry = false;\r\n      query.outFields = [\"CODPARRO\", \"PARROQUIA\"];\r\n      query.orderByFields = [\"PARROQUIA\"];\r\n      query.where = \"CODCONC = \" + codigoParroquia;\r\n\r\n      queryTask.execute(query, lang.hitch(this, function(results) {\r\n        let opt = document.createElement('option');\r\n        opt.value = -1;\r\n        opt.text = \"Seleccione parroquia\";\r\n        this.selectParroquias.add(opt);\r\n        for (let i = 0; i < results.features.length; i++) {\r\n          opt = document.createElement('option');\r\n          opt.value = results.features[i].attributes.CODPARRO;\r\n          opt.text = results.features[i].attributes.PARROQUIA;\r\n          this.selectParroquias.add(opt);\r\n        }\r\n      }));\r\n    },\r\n\r\n    zoomConcello() {\r\n      let codigoConcello = this.selectConcellos.value;\r\n      if (codigoConcello === -1) return;\r\n\r\n      const queryTask = new QueryTask(this.config.concellosService);\r\n      const query = new Query();\r\n      query.returnGeometry = true;\r\n      query.outFields = [\"CODCONC\", \"CONCELLO\"];\r\n      query.orderByFields = [\"CONCELLO\"];\r\n      query.where = \"CODCONC = \" + codigoConcello;\r\n      query.outSpatialReference = new SpatialReference(102100);\r\n\r\n      queryTask.execute(query, lang.hitch(this, function(results) {\r\n        if (results.features.length > 0) {\r\n        console.log('results zoomConcello', results);\r\n        let geom = results.features[0].geometry;\r\n        this.map.graphics.clear();\r\n        this.map.graphics.add(new Graphic(geom, new SimpleFillSymbol()));\r\n        this.map.setExtent(geom.getExtent(), true);\r\n      }\r\n      }));\r\n    },\r\n    \r\n    zoomParroquia() {\r\n      let codigoParroquia = this.selectParroquias.value;\r\n      if (codigoParroquia === -1) return;\r\n     \r\n      console.log('codigoParroquia', codigoParroquia)\r\n      const queryTask = new QueryTask(this.config.parroquiasService);\r\n      const query = new Query();\r\n      query.returnGeometry = true;\r\n      query.outFields = [\"CODPARRO\", \"PARROQUIA\"];\r\n      query.orderByFields = [\"PARROQUIA\"];\r\n      query.where = \"CODPARRO = \" + codigoParroquia;\r\n      query.outSpatialReference = new SpatialReference(102100);\r\n\r\n      queryTask.execute(query, lang.hitch(this, function(results) {\r\n        console.log('results zoomParroquia', results);\r\n        if (results.features.length > 0) {\r\n        let geom = results.features[0].geometry;\r\n        this.map.graphics.clear();\r\n        this.map.graphics.add(new Graphic(geom, new SimpleFillSymbol()));\r\n        this.map.setExtent(geom.getExtent(), true);\r\n        }\r\n      }));\r\n    }\r\n\r\n  });\r\n\r\n});\r\n"]}